<head>
	<script src="plotly-latest.min.js"></script>
</head>

<div id="tester" style="width:600px;height:250px;"></div>

<body>
	<div id="table"></div>
</body>


<script>
	/***************
	 *  CONSTANTS  *
	 ***************/

	//sets the [default] range of values for random number generation
	const MIN = 0;
	const MAX = 1;

	//sets the [default] size of our matrix of data
	const ROWS = 10;
	const COLS = 10;

	//sets how long the visuals will be displayed
	const WAIT_MILLIS = 5000;

	/***************
	 *  FUNCTIONS  *
	 ***************/

	// generates a random int between min and max
	function randGen(min, max)
	{
		return Math.round(Math.random() * (max-min) + min);
	}
	
	// Generates a rows by cols matrix of ints between min and max
	function matrixGen(rows, cols, min, max) 
	{
		var matrix = [];
		
		for (i = 0; i < rows; i++)
			{
				temp = [];
				for (j = 0; j < cols; j++)
				{
					temp.push(randGen(min,max));
				}
				matrix.push(temp);
			}
		
		return matrix;
	}
	
	//plots a table of default size in the default range
	function plotRandTable(name) {
		var valueArray = matrixGen(ROWS, COLS, MIN, MAX);

		var tableParams = [{
				type: 'table',
				header: {
					values: [],
					align: "center",
					line: {width: 1, color: 'black'},
					fill: {color: "white"},
					font: {family: "Arial", size: 12, color: "white"}
				},
			cells: {
				values: valueArray,
				align: "center",
				line: {color: "black", width: 1},
				font: {family: "Arial", size: 11, color: ["black"]}
				}
		}]

		Plotly.plot(name, tableParams);
	}

	function plotRandAnnotatedHeatmap(name) {
		//column indices: just runs from 0 to COLS - 1
		var xValues = [...Array(COLS).keys()];

		//row indices: just runs from 0 to ROWS - 1
		var yValues = [...Array(ROWS).keys()];

		//the actual data
		var zValues = matrixGen(ROWS, COLS, MIN, MAX);
 
		//make all the backgrounds pure white (can change later)
		var colorscaleValue = [
			[0, '#ffffff'],
			[1, '#ffffff']
		];

		var data = [{
			x: xValues,
			y: yValues,
			z: zValues,
			type: 'heatmap',
			colorscale: colorscaleValue,
			showscale: false
		}];

		var layout = {
			title: 'Annotated Heatmap',
			annotations: [],
			xaxis: {
				ticks: '',
				side: 'top'
			},
			yaxis: {
				ticks: '',
				ticksuffix: ' ',
				width: 700,
				height: 700,
				autosize: false
			}
		};

		for ( var i = 0; i < yValues.length; i++ ) {
			for ( var j = 0; j < xValues.length; j++ ) {
				var result = {
					xref: 'x1',
					yref: 'y1',
					x: xValues[j],
					y: yValues[i],
					text: zValues[i][j],
					font: {
						family: 'Arial',
						size: 12,
						color: 'rgb(50, 171, 96)'
					},
					showarrow: false,
					font: {
						color: 'black'
					}
				};
				layout.annotations.push(result);
			}
		}

		Plotly.newPlot(name, data, layout);
	}	

	/***************
	 *  MAIN BODY  *
	 ***************/
	const NAME = 'table';
	//plotRandTable(NAME);
	plotRandAnnotatedHeatmap(NAME);	

	//delete the table after WAIT_MILLIS
	setTimeout(() => Plotly.purge(NAME), WAIT_MILLIS);

</script>
